<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- This manual is for Org version 9.2.

Copyright (C) 2004-2019  Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with no
Invariant Sections, with the Front-Cover Texts being "A GNU Manual,"
and with the Back-Cover Texts as in (a) below.  A copy of the license
is included in the section entitled "GNU Free Documentation License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and
modify this GNU manual."
 -->
<!-- Created by GNU Texinfo 6.3, http://www.gnu.org/software/texinfo/ -->
<head>
<title>The Org Manual: Advanced topics in ODT export</title>

<meta name="description" content="The Org Manual: Advanced topics in ODT export">
<meta name="keywords" content="The Org Manual: Advanced topics in ODT export">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link href="index.html#Top" rel="start" title="Top">
<link href="Main-Index.html#Main-Index" rel="index" title="Main Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="OpenDocument-Text-Export.html#OpenDocument-Text-Export" rel="up" title="OpenDocument Text Export">
<link href="Org-Export.html#Org-Export" rel="next" title="Org Export">
<link href="Literal-examples-in-ODT-export.html#Literal-examples-in-ODT-export" rel="prev" title="Literal examples in ODT export">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
blockquote.smallindentedblock {margin-right: 0em; font-size: smaller}
blockquote.smallquotation {font-size: smaller}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
div.smalldisplay {margin-left: 3.2em}
div.smallexample {margin-left: 3.2em}
div.smalllisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: inherit; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: inherit; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="en">
<a name="Advanced-topics-in-ODT-export"></a>
<div class="header">
<p>
Previous: <a href="Literal-examples-in-ODT-export.html#Literal-examples-in-ODT-export" accesskey="p" rel="prev">Literal examples in ODT export</a>, Up: <a href="OpenDocument-Text-Export.html#OpenDocument-Text-Export" accesskey="u" rel="up">OpenDocument Text Export</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Main-Index.html#Main-Index" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<a name="Advanced-topics-in-ODT-export-1"></a>
<h4 class="subsection">12.12.12 Advanced topics in ODT export</h4>

<p>The ODT export back-end has extensive features useful for power users
and frequent uses of ODT formats.
</p>
<a name="Configuring-a-document-converter"></a><a name="Configuring-a-document-converter-1"></a>
<h4 class="subsubheading">Configuring a document converter</h4>

<a name="index-convert"></a>
<a name="index-doc_002c-docx_002c-rtf"></a>
<a name="index-converter"></a>

<p>The ODT export back-end works with popular converters with little or
no extra configuration.  See <a href="Extending-ODT-export.html#Extending-ODT-export">Extending ODT export</a>.  The following is
for unsupported converters or tweaking existing defaults.
</p>
<dl compact="compact">
<dt>Register the converter</dt>
<dd><a name="index-org_002dexport_002dodt_002dconvert_002dprocesses"></a>
<p>Add the name of the converter to the <code>org-odt-convert-processes</code>
variable.  Note that it also requires how the converter is
invoked on the command line.  See the variable&rsquo;s docstring for
details.
</p>
</dd>
<dt>Configure its capabilities</dt>
<dd><a name="index-org_002dexport_002dodt_002dconvert_002dcapabilities"></a>
<p>Specify which formats the converter can handle by customizing the
variable <code>org-odt-convert-capabilities</code>.  Use the entry for the
default values in this variable for configuring the new
converter.  Also see its docstring for details.
</p>
</dd>
<dt>Choose the converter</dt>
<dd><a name="index-org_002dexport_002dodt_002dconvert_002dprocess"></a>
<p>Select the newly added converter as the preferred one by
customizing the option <code>org-odt-convert-process</code>.
</p></dd>
</dl>

<a name="Working-with-OpenDocument-style-files"></a><a name="Working-with-OpenDocument-style-files-1"></a>
<h4 class="subsubheading">Working with OpenDocument style files</h4>

<a name="index-styles_002c-custom-1"></a>
<a name="index-template_002c-custom-1"></a>

<p>This section explores the internals of the ODT exporter; the means by which
it produces styled documents; the use of automatic and custom OpenDocument
styles.
</p>
<p>The ODT exporter relies on two files for generating its output.  These
files are bundled with the distribution under the directory pointed to
by the variable <code>org-odt-styles-dir</code>.  The two files are:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>OrgOdtStyles.xml</samp>&rsquo; <a name="x_002dorgodtstyles_002dxml"></a></dt>
<dd><p>This file contributes to the &lsquo;<samp>styles.xml</samp>&rsquo; file of the final ODT
document.  This file gets modified for the following purposes:
</p>
<ol>
<li> To control outline numbering based on user settings;

</li><li> To add styles generated by &lsquo;<samp>htmlfontify.el</samp>&rsquo; for fontification of
code blocks.
</li></ol>

</dd>
<dt>&lsquo;<samp>OrgOdtContentTemplate.xml</samp>&rsquo; <a name="x_002dorgodtcontenttemplate_002dxml"></a></dt>
<dd><p>This file contributes to the &lsquo;<samp>content.xml</samp>&rsquo; file of the final ODT
document.  The contents of the Org outline are inserted between the
&lsquo;<samp>&lt;office:text&gt;</samp>&rsquo; &hellip; &lsquo;<samp>&lt;/office:text&gt;</samp>&rsquo; elements of this file.
</p>
<p>Apart from serving as a template file for the final &lsquo;<samp>content.xml</samp>&rsquo;,
the file serves the following purposes:
</p>
<ol>
<li> It contains automatic styles for formatting of tables which are
referenced by the exporter;

</li><li> It contains &lsquo;<samp>&lt;text:sequence-decl&gt;</samp>&rsquo; &hellip; &lsquo;<samp>&lt;/text:sequence-decl&gt;</samp>&rsquo;
elements that control numbering of tables, images, equations, and
similar entities.
</li></ol>
</dd>
</dl>

<a name="x_002doverriding_002dfactory_002dstyles"></a><p>The following two variables control
the location from where the ODT exporter picks up the custom styles
and content template files.  Customize these variables to override the
factory styles used by the exporter.
</p>
<dl compact="compact">
<dt><code>org-odt-styles-file</code></dt>
<dd><p>The ODT export back-end uses the file pointed to by this
variable, such as &lsquo;<samp>styles.xml</samp>&rsquo;, for the final output.  It can
take one of the following values:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>FILE.xml</samp>&rsquo;</dt>
<dd><p>Use this file instead of the default &lsquo;<samp>styles.xml</samp>&rsquo;
</p>
</dd>
<dt>&lsquo;<samp>FILE.odt</samp>&rsquo; or &lsquo;<samp>FILE.ott</samp>&rsquo;</dt>
<dd><p>Use the &lsquo;<samp>styles.xml</samp>&rsquo; contained in the specified OpenDocument
Text or Template file
</p>
</dd>
<dt>&lsquo;<samp>FILE.odt</samp>&rsquo; or &lsquo;<samp>FILE.ott</samp>&rsquo; and a subset of included files</dt>
<dd><p>Use the &lsquo;<samp>styles.xml</samp>&rsquo; contained in the specified OpenDocument
Text or Template file.  Additionally extract the specified
member files and embed those within the final ODT document.
</p>
<p>Use this option if the &lsquo;<samp>styles.xml</samp>&rsquo; file references additional
files like header and footer images.
</p>
</dd>
<dt><code>nil</code></dt>
<dd><p>Use the default &lsquo;<samp>styles.xml</samp>&rsquo;.
</p></dd>
</dl>

</dd>
<dt><code>org-odt-content-template-file</code></dt>
<dd><p>Use this variable to specify the blank &lsquo;<samp>content.xml</samp>&rsquo; used in the
final output.
</p></dd>
</dl>

<a name="Creating-one_002doff-styles"></a><a name="Creating-one_002doff-styles-1"></a>
<h4 class="subsubheading">Creating one-off styles</h4>

<p>The ODT export back-end can read embedded raw OpenDocument XML from
the Org file.  Such direct formatting is useful for one-off instances.
</p>
<dl compact="compact">
<dt>Embedding ODT tags as part of regular text</dt>
<dd><p>Enclose OpenDocument syntax in &lsquo;<samp>@@odt:...@@</samp>&rsquo; for inline markup.
For example, to highlight a region of text do the following:
</p>
<div class="example">
<pre class="example">@@odt:&lt;text:span text:style-name=&quot;Highlight&quot;&gt;This is highlighted
text&lt;/text:span&gt;@@.  But this is regular text.
</pre></div>

<p><strong>Hint:</strong> To see the above example in action, edit the &lsquo;<samp>styles.xml</samp>&rsquo;
(see <a href="#x_002dorgodtstyles_002dxml">Factory styles</a>) and add a custom <em>Highlight</em> style as shown
below:
</p>
<div class="example">
<pre class="example">&lt;style:style style:name=&quot;Highlight&quot; style:family=&quot;text&quot;&gt;
  &lt;style:text-properties fo:background-color=&quot;#ff0000&quot;/&gt;
&lt;/style:style&gt;
</pre></div>

</dd>
<dt>Embedding a one-line OpenDocument XML</dt>
<dd><a name="index-ODT_002c-keyword"></a>
<p>The ODT export back-end can read one-liner options with &lsquo;<samp>#+ODT:</samp>&rsquo;
in the Org file.  For example, to force a page break:
</p>
<div class="example">
<pre class="example">#+ODT: &lt;text:p text:style-name=&quot;PageBreak&quot;/&gt;
</pre></div>

<p><strong>Hint:</strong> To see the above example in action, edit your
&lsquo;<samp>styles.xml</samp>&rsquo; (see <a href="#x_002dorgodtstyles_002dxml">Factory styles</a>) and add a custom &lsquo;<samp>PageBreak</samp>&rsquo;
style as shown below.
</p>
<div class="example">
<pre class="example">&lt;style:style style:name=&quot;PageBreak&quot; style:family=&quot;paragraph&quot;
             style:parent-style-name=&quot;Text_20_body&quot;&gt;
  &lt;style:paragraph-properties fo:break-before=&quot;page&quot;/&gt;
&lt;/style:style&gt;
</pre></div>

</dd>
<dt>Embedding a block of OpenDocument XML</dt>
<dd><p>The ODT export back-end can also read ODT export blocks for
OpenDocument XML.  Such blocks use the &lsquo;<samp>#+BEGIN_EXPORT odt</samp>&rsquo;
&hellip; &lsquo;<samp>#+END_EXPORT</samp>&rsquo; constructs.
</p>
<p>For example, to create a one-off paragraph that uses bold text,
do the following:
</p>
<div class="example">
<pre class="example">#+BEGIN_EXPORT odt
  &lt;text:p text:style-name=&quot;Text_20_body_20_bold&quot;&gt;
  This paragraph is specially formatted and uses bold text.
  &lt;/text:p&gt;
#+END_EXPORT
</pre></div>
</dd>
</dl>

<a name="Customizing-tables-in-ODT-export"></a><a name="Customizing-tables-in-ODT-export-1"></a>
<h4 class="subsubheading">Customizing tables in ODT export</h4>

<a name="index-tables_002c-in-ODT-export-1"></a>
<a name="index-ATTR_005fODT_002c-keyword-3"></a>

<p>Override the default table format by specifying a custom table style
with the &lsquo;<samp>#+ATTR_ODT</samp>&rsquo; line.  For a discussion on default formatting of
tables, see <a href="Tables-in-ODT-export.html#Tables-in-ODT-export">Tables in ODT export</a>.
</p>
<p>This feature closely mimics the way table templates are defined in the
OpenDocument-v1.2 specification<a name="DOCF136" href="#FOOT136"><sup>136</sup></a>.
</p>
<a name="index-org_002dodt_002dtable_002dstyles"></a>
<p>For quick preview of this feature, install the settings below and export the
table that follows:
</p>
<div class="lisp">
<pre class="lisp">(setq org-export-odt-table-styles
      (append org-export-odt-table-styles
              '((&quot;TableWithHeaderRowAndColumn&quot; &quot;Custom&quot;
                 ((use-first-row-styles . t)
                  (use-first-column-styles . t)))
                (&quot;TableWithFirstRowandLastRow&quot; &quot;Custom&quot;
                 ((use-first-row-styles . t)
                  (use-last-row-styles . t))))))
</pre></div>

<div class="example">
<pre class="example">#+ATTR_ODT: :style TableWithHeaderRowAndColumn
| Name  | Phone | Age |
| Peter |  1234 |  17 |
| Anna  |  4321 |  25 |
</pre></div>

<p>The example above used &lsquo;<samp>Custom</samp>&rsquo; template and installed two table
styles &lsquo;<samp>TableWithHeaderRowAndColumn</samp>&rsquo; and
&lsquo;<samp>TableWithFirstRowandLastRow</samp>&rsquo;.  <strong>Important:</strong> The OpenDocument styles
needed for producing the above template were pre-defined.  They are
available in the section marked &lsquo;<samp>Custom Table Template</samp>&rsquo; in
&lsquo;<samp>OrgOdtContentTemplate.xml</samp>&rsquo; (see <a href="#x_002dorgodtcontenttemplate_002dxml">Factory styles</a>).  For adding new
templates, define new styles there.
</p>
<p>To use this feature proceed as follows:
</p>
<ol>
<li> Create a table template<a name="DOCF137" href="#FOOT137"><sup>137</sup></a>.

<p>A table template is set of &lsquo;<samp>table-cell</samp>&rsquo; and &lsquo;<samp>paragraph</samp>&rsquo; styles for
each of the following table cell categories:
</p>
<ul>
<li> Body
</li><li> First column
</li><li> Last column
</li><li> First row
</li><li> Last row
</li><li> Even row
</li><li> Odd row
</li><li> Even column
</li><li> Odd Column
</li></ul>

<p>The names for the above styles must be chosen based on the name of
the table template using a well-defined convention.
</p>
<p>The naming convention is better illustrated with an example.  For
a table template with the name &lsquo;<samp>Custom</samp>&rsquo;, the needed style names are
listed in the following table.
</p>
<table>
<thead><tr><th>Cell type</th><th>Cell style</th><th>Paragraph style</th></tr></thead>
<tr><td>Body</td><td>&lsquo;<samp>CustomTableCell</samp>&rsquo;</td><td>&lsquo;<samp>CustomTableParagraph</samp>&rsquo;</td></tr>
<tr><td>First column</td><td>&lsquo;<samp>CustomFirstColumnTableCell</samp>&rsquo;</td><td>&lsquo;<samp>CustomFirstColumnTableParagraph</samp>&rsquo;</td></tr>
<tr><td>Last column</td><td>&lsquo;<samp>CustomLastColumnTableCell</samp>&rsquo;</td><td>&lsquo;<samp>CustomLastColumnTableParagraph</samp>&rsquo;</td></tr>
<tr><td>First row</td><td>&lsquo;<samp>CustomFirstRowTableCell</samp>&rsquo;</td><td>&lsquo;<samp>CustomFirstRowTableParagraph</samp>&rsquo;</td></tr>
<tr><td>Last row</td><td>&lsquo;<samp>CustomLastRowTableCell</samp>&rsquo;</td><td>&lsquo;<samp>CustomLastRowTableParagraph</samp>&rsquo;</td></tr>
<tr><td>Even row</td><td>&lsquo;<samp>CustomEvenRowTableCell</samp>&rsquo;</td><td>&lsquo;<samp>CustomEvenRowTableParagraph</samp>&rsquo;</td></tr>
<tr><td>Odd row</td><td>&lsquo;<samp>CustomOddRowTableCell</samp>&rsquo;</td><td>&lsquo;<samp>CustomOddRowTableParagraph</samp>&rsquo;</td></tr>
<tr><td>Even column</td><td>&lsquo;<samp>CustomEvenColumnTableCell</samp>&rsquo;</td><td>&lsquo;<samp>CustomEvenColumnTableParagraph</samp>&rsquo;</td></tr>
<tr><td>Odd column</td><td>&lsquo;<samp>CustomOddColumnTableCell</samp>&rsquo;</td><td>&lsquo;<samp>CustomOddColumnTableParagraph</samp>&rsquo;</td></tr>
</table>

<p>To create a table template with the name &lsquo;<samp>Custom</samp>&rsquo;, define the above
styles in the &lsquo;<samp>&lt;office:automatic-styles&gt;</samp>&rsquo; &hellip;
&lsquo;<samp>&lt;/office:automatic-styles&gt;</samp>&rsquo; element of the content template file
(see <a href="#x_002dorgodtcontenttemplate_002dxml">Factory styles</a>).
</p>
</li><li> Define a table style<a name="DOCF138" href="#FOOT138"><sup>138</sup></a>.

<a name="index-org_002dodt_002dtable_002dstyles-1"></a>
<p>To define a table style, create an entry for the style in the
variable <code>org-odt-table-styles</code> and specify the following:
</p>
<ul>
<li> the name of the table template created in step (1),
</li><li> the set of cell styles in that template that are to be activated.
</li></ul>

<p>For example, the entry below defines two different table styles
&lsquo;<samp>TableWithHeaderRowAndColumn</samp>&rsquo; and &lsquo;<samp>TableWithFirstRowandLastRow</samp>&rsquo;
based on the same template &lsquo;<samp>Custom</samp>&rsquo;.  The styles achieve their
intended effect by selectively activating the individual cell
styles in that template.
</p>
<div class="lisp">
<pre class="lisp">(setq org-export-odt-table-styles
      (append org-export-odt-table-styles
              '((&quot;TableWithHeaderRowAndColumn&quot; &quot;Custom&quot;
                 ((use-first-row-styles . t)
                  (use-first-column-styles . t)))
                (&quot;TableWithFirstRowandLastRow&quot; &quot;Custom&quot;
                 ((use-first-row-styles . t)
                  (use-last-row-styles . t))))))
</pre></div>

</li><li> Associate a table with the table style.

<p>To do this, specify the table style created in step (2) as part of
the &lsquo;<samp>ATTR_ODT</samp>&rsquo; line as shown below.
</p>
<div class="example">
<pre class="example">#+ATTR_ODT: :style TableWithHeaderRowAndColumn
| Name  | Phone | Age |
| Peter |  1234 |  17 |
| Anna  |  4321 |  25 |
</pre></div>
</li></ol>

<a name="Validating-OpenDocument-XML"></a><a name="Validating-OpenDocument-XML-1"></a>
<h4 class="subsubheading">Validating OpenDocument XML</h4>

<p>Sometimes ODT format files may not open due to &lsquo;<samp>.odt</samp>&rsquo; file corruption.
To verify if such a file is corrupt, validate it against the
OpenDocument Relax NG Compact (RNC) syntax schema.  But first the
&lsquo;<samp>.odt</samp>&rsquo; files have to be decompressed using &lsquo;<samp>zip</samp>&rsquo;.  Note that &lsquo;<samp>.odt</samp>&rsquo;
files are ZIP archives: <a href="http://www.gnu.org/software/emacs/manual/html_node/emacs/File-Archives.html#File-Archives">(emacs)File Archives</a>.  The contents of
ODT files are in XML.  For general help with validation&mdash;and
schema-sensitive editing&mdash;of XML files:
<a href="http://www.gnu.org/software/emacs/manual/html_node/nxml-mode/Introduction.html#Introduction">(nxml-mode)Introduction</a>.
</p>
<a name="index-org_002dexport_002dodt_002dschema_002ddir"></a>
<p>Customize <code>org-odt-schema-dir</code> to point to a directory with
OpenDocument RNC files and the needed schema-locating rules.  The ODT
export back-end takes care of updating the
<code>rng-schema-locating-files</code>.
</p>
<div class="footnote">
<hr>
<h4 class="footnotes-heading">Footnotes</h4>

<h3><a name="FOOT136" href="#DOCF136">(136)</a></h3>
<p><a href="http://docs.oasis-open.org/office/v1.2/OpenDocument-v1.2.html">OpenDocument-v1.2 Specification</a></p>
<h3><a name="FOOT137" href="#DOCF137">(137)</a></h3>
<p>See the &lsquo;<samp>&lt;table:table-template&gt;</samp>&rsquo; element of the
OpenDocument-v1.2 specification.</p>
<h3><a name="FOOT138" href="#DOCF138">(138)</a></h3>
<p>See the attributes &lsquo;<samp>table:template-name</samp>&rsquo;,
&lsquo;<samp>table:use-first-row-styles</samp>&rsquo;, &lsquo;<samp>table:use-last-row-styles</samp>&rsquo;,
&lsquo;<samp>table:use-first-column-styles</samp>&rsquo;, &lsquo;<samp>table:use-last-column-styles</samp>&rsquo;,
&lsquo;<samp>table:use-banding-rows-styles</samp>&rsquo;, and &lsquo;<samp>table:use-banding-column-styles</samp>&rsquo;
of the &lsquo;<samp>&lt;table:table&gt;</samp>&rsquo; element in the OpenDocument-v1.2 specification.</p>
</div>
<hr>
<div class="header">
<p>
Previous: <a href="Literal-examples-in-ODT-export.html#Literal-examples-in-ODT-export" accesskey="p" rel="prev">Literal examples in ODT export</a>, Up: <a href="OpenDocument-Text-Export.html#OpenDocument-Text-Export" accesskey="u" rel="up">OpenDocument Text Export</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Main-Index.html#Main-Index" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
