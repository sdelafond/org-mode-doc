<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- This manual is for Org version 9.3.

Copyright (C) 2004-2019  Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with no
Invariant Sections, with the Front-Cover Texts being "A GNU Manual,"
and with the Back-Cover Texts as in (a) below.  A copy of the license
is included in the section entitled "GNU Free Documentation License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and
modify this GNU manual."
 -->
<!-- Created by GNU Texinfo 6.5, http://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>References (The Org Manual)</title>

<meta name="description" content="References (The Org Manual)">
<meta name="keywords" content="References (The Org Manual)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="index.html#Top" rel="start" title="Top">
<link href="Main-Index.html#Main-Index" rel="index" title="Main Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="The-Spreadsheet.html#The-Spreadsheet" rel="up" title="The Spreadsheet">
<link href="Formula-syntax-for-Calc.html#Formula-syntax-for-Calc" rel="next" title="Formula syntax for Calc">
<link href="The-Spreadsheet.html#The-Spreadsheet" rel="prev" title="The Spreadsheet">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
blockquote.smallindentedblock {margin-right: 0em; font-size: smaller}
blockquote.smallquotation {font-size: smaller}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
div.smalldisplay {margin-left: 3.2em}
div.smallexample {margin-left: 3.2em}
div.smalllisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: inherit; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: inherit; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="en">
<a name="References"></a>
<div class="header">
<p>
Next: <a href="Formula-syntax-for-Calc.html#Formula-syntax-for-Calc" accesskey="n" rel="next">Formula syntax for Calc</a>, Up: <a href="The-Spreadsheet.html#The-Spreadsheet" accesskey="u" rel="up">The Spreadsheet</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Main-Index.html#Main-Index" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<a name="References-1"></a>
<h4 class="subsection">3.5.1 References</h4>

<a name="index-references"></a>

<p>To compute fields in the table from other fields, formulas must
reference other fields or ranges.  In Org, fields can be referenced by
name, by absolute coordinates, and by relative coordinates.  To find
out what the coordinates of a field are, press <kbd>C-c ?</kbd> in
that field, or press <kbd>C-c }</kbd> to toggle the display of a grid.
</p>
<a name="Field-references"></a><a name="Field-references-1"></a>
<h4 class="subsubheading">Field references</h4>

<a name="index-field-references"></a>
<a name="index-references_002c-to-fields"></a>
<p>Formulas can reference the value of another field in two ways.  Like
in any other spreadsheet, you may reference fields with
a letter/number combination like &lsquo;<samp>B3</samp>&rsquo;, meaning the second field in the
third row.  However, Org prefers to use another, more general
representation that looks like this:<a name="DOCF18" href="#FOOT18"><sup>18</sup></a>
</p>
<div class="example">
<pre class="example">@ROW$COLUMN
</pre></div>


<p>Column specifications can be absolute like &lsquo;<samp>$1</samp>&rsquo;, &lsquo;<samp>$2</samp>&rsquo;, &hellip;, &lsquo;<samp>$N</samp>&rsquo;, or
relative to the current column, i.e., the column of the field which is
being computed, like &lsquo;<samp>$+1</samp>&rsquo; or &lsquo;<samp>$-2</samp>&rsquo;.  &lsquo;<samp>$&lt;</samp>&rsquo; and &lsquo;<samp>$&gt;</samp>&rsquo; are immutable
references to the first and last column, respectively, and you can use
&lsquo;<samp>$&gt;&gt;&gt;</samp>&rsquo; to indicate the third column from the right.
</p>
<p>The row specification only counts data lines and ignores horizontal
separator lines, or &ldquo;hlines&rdquo;.  Like with columns, you can use absolute
row numbers &lsquo;<samp>@1</samp>&rsquo;, &lsquo;<samp>@2</samp>&rsquo;, &hellip;, &lsquo;<samp>@N</samp>&rsquo;, and row numbers relative to the
current row like &lsquo;<samp>@+3</samp>&rsquo; or &lsquo;<samp>@-1</samp>&rsquo;.  &lsquo;<samp>@&lt;</samp>&rsquo; and &lsquo;<samp>@&gt;</samp>&rsquo; are immutable
references the first and last row in the table, respectively.  You may
also specify the row relative to one of the hlines: &lsquo;<samp>@I</samp>&rsquo; refers to the
first hline, &lsquo;<samp>@II</samp>&rsquo; to the second, etc.  &lsquo;<samp>@-I</samp>&rsquo; refers to the first such
line above the current line, &lsquo;<samp>@+I</samp>&rsquo; to the first such line below the
current line.  You can also write &lsquo;<samp>@III+2</samp>&rsquo; which is the second data
line after the third hline in the table.
</p>
<p>&lsquo;<samp>@0</samp>&rsquo; and &lsquo;<samp>$0</samp>&rsquo; refer to the current row and column, respectively, i.e.,
to the row/column for the field being computed.  Also, if you omit
either the column or the row part of the reference, the current
row/column is implied.
</p>
<p>Org&rsquo;s references with <em>unsigned</em> numbers are fixed references in the
sense that if you use the same reference in the formula for two
different fields, the same field is referenced each time.  Org&rsquo;s
references with <em>signed</em> numbers are floating references because the
same reference operator can reference different fields depending on
the field being calculated by the formula.
</p>
<p>Here are a few examples:
</p>
<table>
<tr><td width="20%">&lsquo;<samp>@2$3</samp>&rsquo;</td><td width="80%">2nd row, 3rd column (same as &lsquo;<samp>C2</samp>&rsquo;)</td></tr>
<tr><td width="20%">&lsquo;<samp>$5</samp>&rsquo;</td><td width="80%">column 5 in the current row (same as &lsquo;<samp>E&amp;</samp>&rsquo;)</td></tr>
<tr><td width="20%">&lsquo;<samp>@2</samp>&rsquo;</td><td width="80%">current column, row 2</td></tr>
<tr><td width="20%">&lsquo;<samp>@-1$-3</samp>&rsquo;</td><td width="80%">field one row up, three columns to the left</td></tr>
<tr><td width="20%">&lsquo;<samp>@-I$2</samp>&rsquo;</td><td width="80%">field just under hline above current row, column 2</td></tr>
<tr><td width="20%">&lsquo;<samp>@&gt;$5</samp>&rsquo;</td><td width="80%">field in the last row, in column 5</td></tr>
</table>

<a name="Range-references"></a><a name="Range-references-1"></a>
<h4 class="subsubheading">Range references</h4>

<a name="index-range-references"></a>
<a name="index-references_002c-to-ranges"></a>
<p>You may reference a rectangular range of fields by specifying two
field references connected by two dots &lsquo;<samp>..</samp>&rsquo;.  If both fields are in
the current row, you may simply use &lsquo;<samp>$2..$7</samp>&rsquo;, but if at least one
field is in a different row, you need to use the general &lsquo;<samp>@ROW$COLUMN</samp>&rsquo;
format at least for the first field, i.e., the reference must start
with &lsquo;<samp>@</samp>&rsquo; in order to be interpreted correctly.  Examples:
</p>
<table>
<tr><td width="20%">&lsquo;<samp>$1..$3</samp>&rsquo;</td><td width="80%">first three fields in the current row</td></tr>
<tr><td width="20%">&lsquo;<samp>$P..$Q</samp>&rsquo;</td><td width="80%">range, using column names (see <a href="Advanced-features.html#Advanced-features">Advanced features</a>)</td></tr>
<tr><td width="20%">&lsquo;<samp>$&lt;&lt;&lt;..$&gt;&gt;</samp>&rsquo;</td><td width="80%">start in third column, continue to the last but one</td></tr>
<tr><td width="20%">&lsquo;<samp>@2$1..@4$3</samp>&rsquo;</td><td width="80%">six fields between these two fields (same as &lsquo;<samp>A2..C4</samp>&rsquo;)</td></tr>
<tr><td width="20%">&lsquo;<samp>@-1$-2..@-1</samp>&rsquo;</td><td width="80%">3 fields in the row above, starting from 2 columns on the left</td></tr>
<tr><td width="20%">&lsquo;<samp>@I..II</samp>&rsquo;</td><td width="80%">between first and second hline, short for &lsquo;<samp>@I..@II</samp>&rsquo;</td></tr>
</table>

<p>Range references return a vector of values that can be fed into Calc
vector functions.  Empty fields in ranges are normally suppressed, so
that the vector contains only the non-empty fields.  For other options
with the mode switches &lsquo;<samp>E</samp>&rsquo;, &lsquo;<samp>N</samp>&rsquo; and examples, see <a href="Formula-syntax-for-Calc.html#Formula-syntax-for-Calc">Formula syntax for Calc</a>.
</p>
<a name="Field-coordinates-in-formulas"></a><a name="Field-coordinates-in-formulas-1"></a>
<h4 class="subsubheading">Field coordinates in formulas</h4>

<a name="index-field-coordinates"></a>
<a name="index-coordinates_002c-of-field"></a>
<a name="index-row_002c-of-field-coordinates"></a>
<a name="index-column_002c-of-field-coordinates"></a>
<a name="index-org_002dtable_002dcurrent_002dcolumn"></a>
<a name="index-org_002dtable_002dcurrent_002ddline"></a>
<p>One of the very first actions during evaluation of Calc formulas and
Lisp formulas is to substitute &lsquo;<samp>@#</samp>&rsquo; and &lsquo;<samp>$#</samp>&rsquo; in the formula with the
row or column number of the field where the current result will go to.
The traditional Lisp formula equivalents are <code>org-table-current-dline</code>
and <code>org-table-current-column</code>.  Examples:
</p>
<dl compact="compact">
<dt>&lsquo;<samp>if(@# % 2, $#, string(&quot;&quot;))</samp>&rsquo;</dt>
<dd><p>Insert column number on odd rows, set field to empty on even rows.
</p>
</dd>
<dt>&lsquo;<samp>$2 = '(identity remote(FOO, @@#$1))</samp>&rsquo;</dt>
<dd><p>Copy text or values of each row of column 1 of the table named
<var>FOO</var> into column 2 of the current table.
</p>
</dd>
<dt>&lsquo;<samp>@3 = 2 * remote(FOO, @@1$$#)</samp>&rsquo;</dt>
<dd><p>Insert the doubled value of each column of row 1 of the table
named <var>FOO</var> into row 3 of the current table.
</p></dd>
</dl>

<p>For the second and third examples, table <var>FOO</var> must have at
least as many rows or columns as the current table.  Note that this is
inefficient<a name="DOCF19" href="#FOOT19"><sup>19</sup></a> for large number of rows.
</p>
<a name="Named-references"></a><a name="Named-references-1"></a>
<h4 class="subsubheading">Named references</h4>

<a name="index-named-references"></a>
<a name="index-references_002c-named"></a>
<a name="index-name_002c-of-column-or-field"></a>
<a name="index-constants_002c-in-calculations"></a>
<a name="index-CONSTANTS_002c-keyword"></a>
<a name="index-org_002dtable_002dformula_002dconstants"></a>

<p>&lsquo;<samp>$name</samp>&rsquo; is interpreted as the name of a column, parameter or constant.
Constants are defined globally through the variable
<code>org-table-formula-constants</code>, and locally&mdash;for the file&mdash;through
a line like this example:
</p>
<div class="example">
<pre class="example">#+CONSTANTS: c=299792458. pi=3.14 eps=2.4e-6
</pre></div>


<a name="index-constants_002dunit_002dsystem"></a>
<a name="index-constants_002eel-1"></a>
<p>Also, properties (see <a href="Properties-and-Columns.html#Properties-and-Columns">Properties and Columns</a>) can be used as
constants in table formulas: for a property &lsquo;<samp>Xyz</samp>&rsquo; use the name
&lsquo;<samp>$PROP_Xyz</samp>&rsquo;, and the property will be searched in the current outline
entry and in the hierarchy above it.  If you have the &lsquo;<samp>constants.el</samp>&rsquo;
package, it will also be used to resolve constants, including natural
constants like &lsquo;<samp>$h</samp>&rsquo; for Planck&rsquo;s constant, and units like &lsquo;<samp>$km</samp>&rsquo; for
kilometers<a name="DOCF20" href="#FOOT20"><sup>20</sup></a>.  Column names and parameters can be specified in
special table lines.  These are described below, see <a href="Advanced-features.html#Advanced-features">Advanced features</a>.  All names must start with a letter, and further consist
of letters and numbers.
</p>
<a name="Remote-references"></a><a name="Remote-references-1"></a>
<h4 class="subsubheading">Remote references</h4>

<a name="index-remote-references"></a>
<a name="index-references_002c-remote"></a>
<a name="index-references_002c-to-a-different-table"></a>
<a name="index-name_002c-of-column-or-field-1"></a>
<a name="index-NAME_002c-keyword"></a>
<p>You may also reference constants, fields and ranges from a different
table, either in the current file or even in a different file.  The
syntax is
</p>
<div class="example">
<pre class="example">remote(NAME,REF)
</pre></div>


<p>where <var>NAME</var> can be the name of a table in the current file
as set by a &lsquo;<samp>#+NAME:</samp>&rsquo; line before the table.  It can also be the ID of
an entry, even in a different file, and the reference then refers to
the first table in that entry.  <var>REF</var> is an absolute field or
range reference as described above for example &lsquo;<samp>@3$3</samp>&rsquo; or &lsquo;<samp>$somename</samp>&rsquo;,
valid in the referenced table.
</p>
<a name="index-table-indirection"></a>
<p>When <var>NAME</var> has the format &lsquo;<samp>@ROW$COLUMN</samp>&rsquo;, it is substituted
with the name or ID found in this field of the current table.  For
example &lsquo;<samp>remote($1, @@&gt;$2)</samp>&rsquo; &rArr; &lsquo;<samp>remote(year_2013, @@&gt;$1)</samp>&rsquo;.  The format
&lsquo;<samp>B3</samp>&rsquo; is not supported because it can not be distinguished from a plain
table name or ID.
</p>
<div class="footnote">
<hr>
<h4 class="footnotes-heading">Footnotes</h4>

<h3><a name="FOOT18" href="#DOCF18">(18)</a></h3>
<p>Org understands references typed by the user as &lsquo;<samp>B4</samp>&rsquo;, but it
does not use this syntax when offering a formula for editing.  You can
customize this behavior using the variable
<code>org-table-use-standard-references</code>.</p>
<h3><a name="FOOT19" href="#DOCF19">(19)</a></h3>
<p>The computation time scales as O(N^2) because table
<var>FOO</var> is parsed for each field to be copied.</p>
<h3><a name="FOOT20" href="#DOCF20">(20)</a></h3>
<p>The file &lsquo;<samp>constants.el</samp>&rsquo; can supply the values of constants in
two different unit systems, &lsquo;<samp>SI</samp>&rsquo; and &lsquo;<samp>cgs</samp>&rsquo;.  Which one is used depends
on the value of the variable <code>constants-unit-system</code>.  You can use the
&lsquo;<samp>STARTUP</samp>&rsquo; options &lsquo;<samp>constSI</samp>&rsquo; and &lsquo;<samp>constcgs</samp>&rsquo; to set this value for the
current buffer.</p>
</div>
<hr>
<div class="header">
<p>
Next: <a href="Formula-syntax-for-Calc.html#Formula-syntax-for-Calc" accesskey="n" rel="next">Formula syntax for Calc</a>, Up: <a href="The-Spreadsheet.html#The-Spreadsheet" accesskey="u" rel="up">The Spreadsheet</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Main-Index.html#Main-Index" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
