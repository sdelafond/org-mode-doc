<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- This manual is for Org version 9.2.

Copyright (C) 2004-2019  Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with no
Invariant Sections, with the Front-Cover Texts being "A GNU Manual,"
and with the Back-Cover Texts as in (a) below.  A copy of the license
is included in the section entitled "GNU Free Documentation License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and
modify this GNU manual."
 -->
<!-- Created by GNU Texinfo 6.3, http://www.gnu.org/software/texinfo/ -->
<head>
<title>The Org Manual: Exporting Agenda Views</title>

<meta name="description" content="The Org Manual: Exporting Agenda Views">
<meta name="keywords" content="The Org Manual: Exporting Agenda Views">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link href="index.html#Top" rel="start" title="Top">
<link href="Main-Index.html#Main-Index" rel="index" title="Main Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Agenda-Views.html#Agenda-Views" rel="up" title="Agenda Views">
<link href="Agenda-Column-View.html#Agenda-Column-View" rel="next" title="Agenda Column View">
<link href="Setting-options.html#Setting-options" rel="prev" title="Setting options">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
blockquote.smallindentedblock {margin-right: 0em; font-size: smaller}
blockquote.smallquotation {font-size: smaller}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
div.smalldisplay {margin-left: 3.2em}
div.smallexample {margin-left: 3.2em}
div.smalllisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: inherit; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: inherit; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="en">
<a name="Exporting-Agenda-Views"></a>
<div class="header">
<p>
Next: <a href="Agenda-Column-View.html#Agenda-Column-View" accesskey="n" rel="next">Agenda Column View</a>, Previous: <a href="Custom-Agenda-Views.html#Custom-Agenda-Views" accesskey="p" rel="prev">Custom Agenda Views</a>, Up: <a href="Agenda-Views.html#Agenda-Views" accesskey="u" rel="up">Agenda Views</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Main-Index.html#Main-Index" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<a name="Exporting-Agenda-Views-1"></a>
<h3 class="section">10.7 Exporting Agenda Views</h3>

<a name="index-agenda-views_002c-exporting"></a>

<p>If you are away from your computer, it can be very useful to have
a printed version of some agenda views to carry around.  Org mode can
export custom agenda views as plain text, HTML<a name="DOCF103" href="#FOOT103"><sup>103</sup></a>, Postscript,
PDF<a name="DOCF104" href="#FOOT104"><sup>104</sup></a>, and iCalendar files.  If you want to do this only
occasionally, use the following command:
</p>
<dl compact="compact">
<dt><kbd>C-x C-w</kbd> (<code>org-agenda-write</code>)</dt>
<dd><a name="index-C_002dx-C_002dw"></a>
<a name="index-org_002dagenda_002dwrite"></a>
<a name="index-exporting-agenda-views"></a>
<a name="index-agenda-views_002c-exporting-1"></a>

<a name="index-org_002dagenda_002dexporter_002dsettings"></a>
<p>Write the agenda view to a file.
</p></dd>
</dl>

<p>If you need to export certain agenda views frequently, you can
associate any custom agenda command with a list of output file
names<a name="DOCF105" href="#FOOT105"><sup>105</sup></a>.  Here is an example that first defines custom commands
for the agenda and the global TODO list, together with a number of
files to which to export them.  Then we define two block agenda
commands and specify file names for them as well.  File names can be
relative to the current working directory, or absolute.
</p>
<div class="lisp">
<pre class="lisp">(setq org-agenda-custom-commands
      '((&quot;X&quot; agenda &quot;&quot; nil (&quot;agenda.html&quot; &quot;agenda.ps&quot;))
        (&quot;Y&quot; alltodo &quot;&quot; nil (&quot;todo.html&quot; &quot;todo.txt&quot; &quot;todo.ps&quot;))
        (&quot;h&quot; &quot;Agenda and Home-related tasks&quot;
         ((agenda &quot;&quot;)
          (tags-todo &quot;home&quot;)
          (tags &quot;garden&quot;))
         nil
         (&quot;~/views/home.html&quot;))
        (&quot;o&quot; &quot;Agenda and Office-related tasks&quot;
         ((agenda)
          (tags-todo &quot;work&quot;)
          (tags &quot;office&quot;))
         nil
         (&quot;~/views/office.ps&quot; &quot;~/calendars/office.ics&quot;))))
</pre></div>

<p>The extension of the file name determines the type of export.  If it
is &lsquo;<samp>.html</samp>&rsquo;, Org mode uses the htmlize package to convert the buffer to
HTML and save it to this file name.  If the extension is &lsquo;<samp>.ps</samp>&rsquo;,
<code>ps-print-buffer-with-faces</code> is used to produce Postscript output.  If
the extension is &lsquo;<samp>.ics</samp>&rsquo;, iCalendar export is run export over all files
that were used to construct the agenda, and limit the export to
entries listed in the agenda.  Any other extension produces a plain
ASCII file.
</p>
<p>The export files are <em>not</em> created when you use one of those
commands interactively because this might use too much overhead.
Instead, there is a special command to produce <em>all</em> specified
files in one step:
</p>
<dl compact="compact">
<dt><kbd>e</kbd> (<code>org-store-agenda-views</code>)</dt>
<dd><a name="index-e-_0028Agenda-dispatcher_0029"></a>
<a name="index-org_002dstore_002dagenda_002dviews"></a>
<p>Export all agenda views that have export file names associated
with them.
</p></dd>
</dl>

<p>You can use the options section of the custom agenda commands to also
set options for the export commands.  For example:
</p>
<div class="lisp">
<pre class="lisp">(setq org-agenda-custom-commands
      '((&quot;X&quot; agenda &quot;&quot;
         ((ps-number-of-columns 2)
          (ps-landscape-mode t)
          (org-agenda-prefix-format &quot; [ ] &quot;)
          (org-agenda-with-colors nil)
          (org-agenda-remove-tags t))
         (&quot;theagenda.ps&quot;))))
</pre></div>

<p><a name="index-org_002dagenda_002dexporter_002dsettings-1"></a>
This command sets two options for the Postscript exporter, to make it
print in two columns in landscape format&mdash;the resulting page can be
cut in two and then used in a paper agenda.  The remaining settings
modify the agenda prefix to omit category and scheduling information,
and instead include a checkbox to check off items.  We also remove the
tags to make the lines compact, and we do not want to use colors for
the black-and-white printer.  Settings specified in
<code>org-agenda-exporter-settings</code> also apply, e.g.,
</p>
<div class="lisp">
<pre class="lisp">(setq org-agenda-exporter-settings
      '((ps-number-of-columns 2)
        (ps-landscape-mode t)
        (org-agenda-add-entry-text-maxlines 5)
        (htmlize-output-type 'css)))
</pre></div>

<p>but the settings in <code>org-agenda-custom-commands</code> take precedence.
</p>
<p>From the command line you may also use:
</p>
<div class="example">
<pre class="example">emacs -eval (org-batch-store-agenda-views) -kill
</pre></div>

<p>or, if you need to modify some parameters<a name="DOCF106" href="#FOOT106"><sup>106</sup></a>
</p>
<div class="example">
<pre class="example">emacs -eval '(org-batch-store-agenda-views                      \
              org-agenda-span (quote month)                     \
              org-agenda-start-day &quot;2007-11-01&quot;                 \
              org-agenda-include-diary nil                      \
              org-agenda-files (quote (&quot;~/org/project.org&quot;)))'  \
      -kill
</pre></div>

<p>which creates the agenda views restricted to the file
&lsquo;<samp>~/org/project.org</samp>&rsquo;, without diary entries and with a 30-day extent.
</p>
<p>You can also extract agenda information in a way that allows further
processing by other programs.  See <a href="Extracting-Agenda-Information.html#Extracting-Agenda-Information">Extracting Agenda Information</a>, for
more information.
</p>
<div class="footnote">
<hr>
<h4 class="footnotes-heading">Footnotes</h4>

<h3><a name="FOOT103" href="#DOCF103">(103)</a></h3>
<p>For HTML you need to install Hrvoje Niksic&rsquo;s &lsquo;<samp>htmlize.el</samp>&rsquo;
from <a href="https://github.com/hniksic/emacs-htmlize">Hrvoje Niksic&rsquo;s repository</a>.</p>
<h3><a name="FOOT104" href="#DOCF104">(104)</a></h3>
<p>To create PDF output, the Ghostscript ps2pdf utility must be
installed on the system.  Selecting a PDF file also creates the
postscript file.</p>
<h3><a name="FOOT105" href="#DOCF105">(105)</a></h3>
<p>If you want to store standard views like the weekly agenda or
the global TODO list as well, you need to define custom commands for
them in order to be able to specify file names.</p>
<h3><a name="FOOT106" href="#DOCF106">(106)</a></h3>
<p>Quoting depends on the system you use, please check the FAQ
for examples.</p>
</div>
<hr>
<div class="header">
<p>
Next: <a href="Agenda-Column-View.html#Agenda-Column-View" accesskey="n" rel="next">Agenda Column View</a>, Previous: <a href="Custom-Agenda-Views.html#Custom-Agenda-Views" accesskey="p" rel="prev">Custom Agenda Views</a>, Up: <a href="Agenda-Views.html#Agenda-Views" accesskey="u" rel="up">Agenda Views</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Main-Index.html#Main-Index" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
