<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- This manual is for Org version 9.2.

Copyright (C) 2004-2019  Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with no
Invariant Sections, with the Front-Cover Texts being "A GNU Manual,"
and with the Back-Cover Texts as in (a) below.  A copy of the license
is included in the section entitled "GNU Free Documentation License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and
modify this GNU manual."
 -->
<!-- Created by GNU Texinfo 6.3, http://www.gnu.org/software/texinfo/ -->
<head>
<title>The Org Manual: Editing and debugging formulas</title>

<meta name="description" content="The Org Manual: Editing and debugging formulas">
<meta name="keywords" content="The Org Manual: Editing and debugging formulas">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<link href="index.html#Top" rel="start" title="Top">
<link href="Main-Index.html#Main-Index" rel="index" title="Main Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="The-Spreadsheet.html#The-Spreadsheet" rel="up" title="The Spreadsheet">
<link href="Updating-the-table.html#Updating-the-table" rel="next" title="Updating the table">
<link href="Lookup-functions.html#Lookup-functions" rel="prev" title="Lookup functions">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
blockquote.smallindentedblock {margin-right: 0em; font-size: smaller}
blockquote.smallquotation {font-size: smaller}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
div.smalldisplay {margin-left: 3.2em}
div.smallexample {margin-left: 3.2em}
div.smalllisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: inherit; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: inherit; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="en">
<a name="Editing-and-debugging-formulas"></a>
<div class="header">
<p>
Next: <a href="Updating-the-table.html#Updating-the-table" accesskey="n" rel="next">Updating the table</a>, Previous: <a href="Lookup-functions.html#Lookup-functions" accesskey="p" rel="prev">Lookup functions</a>, Up: <a href="The-Spreadsheet.html#The-Spreadsheet" accesskey="u" rel="up">The Spreadsheet</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Main-Index.html#Main-Index" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<a name="Editing-and-debugging-formulas-1"></a>
<h4 class="subsection">3.5.8 Editing and debugging formulas</h4>

<a name="index-formula-editing"></a>
<a name="index-editing_002c-of-table-formulas"></a>

<a name="index-org_002dtable_002duse_002dstandard_002dreferences"></a>
<p>You can edit individual formulas in the minibuffer or directly in the
field.  Org can also prepare a special buffer with all active formulas
of a table.  When offering a formula for editing, Org converts
references to the standard format (like &lsquo;<samp>B3</samp>&rsquo; or &lsquo;<samp>D&amp;</samp>&rsquo;) if possible.  If
you prefer to only work with the internal format (like &lsquo;<samp>@3$2</samp>&rsquo; or
&lsquo;<samp>$4</samp>&rsquo;), configure the variable <code>org-table-use-standard-references</code>.
</p>
<dl compact="compact">
<dt><kbd>C-c =</kbd> or <kbd>C-u C-c =</kbd> (<code>org-table-eval-formula</code>)</dt>
<dd><a name="index-C_002dc-_003d-1"></a>
<a name="index-C_002du-C_002dc-_003d-1"></a>
<a name="index-org_002dtable_002deval_002dformula-2"></a>
<p>Edit the formula associated with the current column/field in the
minibuffer.  See <a href="Column-formulas.html#Column-formulas">Column formulas</a>, and <a href="Field-and-range-formulas.html#Field-and-range-formulas">Field and range formulas</a>.
</p>
</dd>
<dt><kbd>C-u C-u C-c =</kbd> (<code>org-table-eval-formula</code>)</dt>
<dd><a name="index-C_002du-C_002du-C_002dc-_003d"></a>
<a name="index-org_002dtable_002deval_002dformula-3"></a>
<p>Re-insert the active formula (either a field formula, or a column
formula) into the current field, so that you can edit it directly
in the field.  The advantage over editing in the minibuffer is
that you can use the command <kbd>C-c ?</kbd>.
</p>
</dd>
<dt><kbd>C-c ?</kbd> (<code>org-table-field-info</code>)</dt>
<dd><a name="index-C_002dc-_003f"></a>
<a name="index-org_002dtable_002dfield_002dinfo"></a>
<p>While editing a formula in a table field, highlight the field(s)
referenced by the reference at point position in the formula.
</p>
</dd>
<dt><kbd>C-c }</kbd> (<code>org-table-toggle-coordinate-overlays</code>)</dt>
<dd><a name="index-C_002dc-_007d"></a>
<a name="index-org_002dtable_002dtoggle_002dcoordinate_002doverlays"></a>
<p>Toggle the display of row and column numbers for a table, using
overlays.  These are updated each time the table is aligned; you
can force it with <kbd>C-c C-c</kbd>.
</p>
</dd>
<dt><kbd>C-c {</kbd> (<code>org-table-toggle-formula-debugger</code>)</dt>
<dd><a name="index-C_002dc-_007b"></a>
<a name="index-org_002dtable_002dtoggle_002dformula_002ddebugger"></a>
<p>Toggle the formula debugger on and off.  See below.
</p>
</dd>
<dt><kbd>C-c '</kbd> (<code>org-table-edit-formulas</code>)</dt>
<dd><a name="index-C_002dc-_0027"></a>
<a name="index-org_002dtable_002dedit_002dformulas"></a>
<p>Edit all formulas for the current table in a special buffer,
where the formulas are displayed one per line.  If the current
field has an active formula, point in the formula editor marks
it.  While inside the special buffer, Org automatically
highlights any field or range reference at point position.  You
may edit, remove and add formulas, and use the following
commands:
</p>
<dl compact="compact">
<dt><kbd>C-c C-c</kbd> or <kbd>C-x C-s</kbd> (<code>org-table-fedit-finish</code>)</dt>
<dd><a name="index-C_002dx-C_002ds"></a>
<a name="index-C_002dc-C_002dc-4"></a>
<a name="index-org_002dtable_002dfedit_002dfinish"></a>
<p>Exit the formula editor and store the modified formulas.  With
<kbd>C-u</kbd> prefix, also apply the new formulas to the
entire table.
</p>
</dd>
<dt><kbd>C-c C-q</kbd> (<code>org-table-fedit-abort</code>)</dt>
<dd><a name="index-C_002dc-C_002dq"></a>
<a name="index-org_002dtable_002dfedit_002dabort"></a>
<p>Exit the formula editor without installing changes.
</p>
</dd>
<dt><kbd>C-c C-r</kbd> (<code>org-table-fedit-toggle-ref-type</code>)</dt>
<dd><a name="index-C_002dc-C_002dr-1"></a>
<a name="index-org_002dtable_002dfedit_002dtoggle_002dref_002dtype"></a>
<p>Toggle all references in the formula editor between standard
(like &lsquo;<samp>B3</samp>&rsquo;) and internal (like &lsquo;<samp>@3$2</samp>&rsquo;).
</p>
</dd>
<dt><kbd><span class="key">TAB</span></kbd> (<code>org-table-fedit-lisp-indent</code>)</dt>
<dd><a name="index-TAB-4"></a>
<a name="index-org_002dtable_002dfedit_002dlisp_002dindent"></a>
<p>Pretty-print or indent Lisp formula at point.  When in a line
containing a Lisp formula, format the formula according to
Emacs Lisp rules.  Another <kbd><span class="key">TAB</span></kbd> collapses the formula
back again.  In the open formula, <kbd><span class="key">TAB</span></kbd> re-indents
just like in Emacs Lisp mode.
</p>
</dd>
<dt><kbd>M-<span class="key">TAB</span></kbd> (<code>lisp-complete-symbol</code>)</dt>
<dd><a name="index-M_002dTAB"></a>
<a name="index-lisp_002dcomplete_002dsymbol"></a>
<p>Complete Lisp symbols, just like in Emacs Lisp mode.
</p>
</dd>
<dt><kbd>S-<span class="key">UP</span></kbd>, <kbd>S-<span class="key">DOWN</span></kbd>, <kbd>S-<span class="key">LEFT</span></kbd>, <kbd>S-<span class="key">RIGHT</span></kbd></dt>
<dd><a name="index-S_002dUP-1"></a>
<a name="index-S_002dDOWN-1"></a>
<a name="index-S_002dLEFT-1"></a>
<a name="index-S_002dRIGHT-1"></a>
<a name="index-org_002dtable_002dfedit_002dref_002dup"></a>
<a name="index-org_002dtable_002dfedit_002dref_002ddown"></a>
<a name="index-org_002dtable_002dfedit_002dref_002dleft"></a>
<a name="index-org_002dtable_002dfedit_002dref_002dright"></a>
<p>Shift the reference at point.  For example, if the reference
is &lsquo;<samp>B3</samp>&rsquo; and you press <kbd>S-<span class="key">RIGHT</span></kbd>, it becomes &lsquo;<samp>C3</samp>&rsquo;.
This also works for relative references and for hline
references.
</p>
</dd>
<dt><kbd>M-S-<span class="key">UP</span></kbd> (<code>org-table-fedit-line-up</code>)</dt>
<dd><a name="index-M_002dS_002dUP-1"></a>
<a name="index-org_002dtable_002dfedit_002dline_002dup"></a>
<p>Move the test line for column formulas up in the Org buffer.
</p>
</dd>
<dt><kbd>M-S-<span class="key">DOWN</span></kbd> (<code>org-table-fedit-line-down</code>)</dt>
<dd><a name="index-M_002dS_002dDOWN-1"></a>
<a name="index-org_002dtable_002dfedit_002dline_002ddown"></a>
<p>Move the test line for column formulas down in the Org buffer.
</p>
</dd>
<dt><kbd>M-<span class="key">UP</span></kbd> (<code>org-table-fedit-scroll-up</code>)</dt>
<dd><a name="index-M_002dUP-3"></a>
<a name="index-org_002dtable_002dfedit_002dscroll_002dup"></a>
<p>Scroll up the window displaying the table.
</p>
</dd>
<dt><kbd>M-<span class="key">DOWN</span></kbd> (<code>org-table-fedit-scroll-down</code>)</dt>
<dd><a name="index-M_002dDOWN-3"></a>
<a name="index-org_002dtable_002dfedit_002dscroll_002ddown"></a>
<p>Scroll down the window displaying the table.
</p>
</dd>
<dt><kbd>C-c }</kbd></dt>
<dd><a name="index-C_002dc-_007d-1"></a>
<a name="index-org_002dtable_002dtoggle_002dcoordinate_002doverlays-1"></a>
<p>Turn the coordinate grid in the table on and off.
</p></dd>
</dl>
</dd>
</dl>

<p>Making a table field blank does not remove the formula associated with
the field, because that is stored in a different line&mdash;the &lsquo;<samp>TBLFM</samp>&rsquo;
keyword line.  During the next recalculation, the field will be filled
again.  To remove a formula from a field, you have to give an empty
reply when prompted for the formula, or to edit the &lsquo;<samp>TBLFM</samp>&rsquo; keyword.
</p>
<a name="index-C_002dc-C_002dc-5"></a>
<p>You may edit the &lsquo;<samp>TBLFM</samp>&rsquo; keyword directly and re-apply the changed
equations with <kbd>C-c C-c</kbd> in that line or with the normal
recalculation commands in the table.
</p>
<a name="Using-multiple-TBLFM-lines"></a><a name="Using-multiple-TBLFM-lines-1"></a>
<h4 class="subsubheading">Using multiple &lsquo;<samp>TBLFM</samp>&rsquo; lines</h4>

<a name="index-multiple-formula-lines"></a>
<a name="index-TBLFM-keywords_002c-multiple"></a>
<a name="index-TBLFM_002c-switching"></a>

<a name="index-C_002dc-C_002dc-6"></a>
<p>You may apply the formula temporarily.  This is useful when you want
to switch the formula applied to the table.  Place multiple &lsquo;<samp>TBLFM</samp>&rsquo;
keywords right after the table, and then press <kbd>C-c C-c</kbd> on
the formula to apply.  Here is an example:
</p>
<div class="example">
<pre class="example">| x | y |
|---+---|
| 1 |   |
| 2 |   |
#+TBLFM: $2=$1*1
#+TBLFM: $2=$1*2
</pre></div>

<p>Pressing <kbd>C-c C-c</kbd> in the line of &lsquo;<samp>#+TBLFM: $2=$1*2</samp>&rsquo; yields:
</p>
<div class="example">
<pre class="example">| x | y |
|---+---|
| 1 | 2 |
| 2 | 4 |
#+TBLFM: $2=$1*1
#+TBLFM: $2=$1*2
</pre></div>

<p>If you recalculate this table, with <kbd>C-u C-c *</kbd>, for example,
you get the following result from applying only the first &lsquo;<samp>TBLFM</samp>&rsquo;
keyword.
</p>
<div class="example">
<pre class="example">| x | y |
|---+---|
| 1 | 1 |
| 2 | 2 |
#+TBLFM: $2=$1*1
#+TBLFM: $2=$1*2
</pre></div>

<a name="Debugging-formulas"></a><a name="Debugging-formulas-1"></a>
<h4 class="subsubheading">Debugging formulas</h4>

<a name="index-formula-debugging"></a>
<a name="index-debugging_002c-of-table-formulas"></a>

<p>When the evaluation of a formula leads to an error, the field content
becomes the string &lsquo;<samp>#ERROR</samp>&rsquo;.  If you would like to see what is going
on during variable substitution and calculation in order to find
a bug, turn on formula debugging in the Tbl menu and repeat the
calculation, for example by pressing <kbd>C-u C-u C-c = <span class="key">RET</span></kbd> in
a field.  Detailed information are displayed.
</p>
<hr>
<div class="header">
<p>
Next: <a href="Updating-the-table.html#Updating-the-table" accesskey="n" rel="next">Updating the table</a>, Previous: <a href="Lookup-functions.html#Lookup-functions" accesskey="p" rel="prev">Lookup functions</a>, Up: <a href="The-Spreadsheet.html#The-Spreadsheet" accesskey="u" rel="up">The Spreadsheet</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Main-Index.html#Main-Index" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
