<!DOCTYPE html PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<html>
<!-- This manual is for Org version 9.3.

Copyright (C) 2004-2019  Free Software Foundation, Inc.

Permission is granted to copy, distribute and/or modify this document
under the terms of the GNU Free Documentation License, Version 1.3 or
any later version published by the Free Software Foundation; with no
Invariant Sections, with the Front-Cover Texts being "A GNU Manual,"
and with the Back-Cover Texts as in (a) below.  A copy of the license
is included in the section entitled "GNU Free Documentation License."

(a) The FSF's Back-Cover Text is: "You have the freedom to copy and
modify this GNU manual."
 -->
<!-- Created by GNU Texinfo 6.5, http://www.gnu.org/software/texinfo/ -->
<head>
<meta http-equiv="Content-Type" content="text/html; charset=utf-8">
<title>Noweb Reference Syntax (The Org Manual)</title>

<meta name="description" content="Noweb Reference Syntax (The Org Manual)">
<meta name="keywords" content="Noweb Reference Syntax (The Org Manual)">
<meta name="resource-type" content="document">
<meta name="distribution" content="global">
<meta name="Generator" content="makeinfo">
<link href="index.html#Top" rel="start" title="Top">
<link href="Main-Index.html#Main-Index" rel="index" title="Main Index">
<link href="index.html#SEC_Contents" rel="contents" title="Table of Contents">
<link href="Working-with-Source-Code.html#Working-with-Source-Code" rel="up" title="Working with Source Code">
<link href="Library-of-Babel.html#Library-of-Babel" rel="next" title="Library of Babel">
<link href="Editing-Source-Code.html#Editing-Source-Code" rel="prev" title="Editing Source Code">
<style type="text/css">
<!--
a.summary-letter {text-decoration: none}
blockquote.indentedblock {margin-right: 0em}
blockquote.smallindentedblock {margin-right: 0em; font-size: smaller}
blockquote.smallquotation {font-size: smaller}
div.display {margin-left: 3.2em}
div.example {margin-left: 3.2em}
div.lisp {margin-left: 3.2em}
div.smalldisplay {margin-left: 3.2em}
div.smallexample {margin-left: 3.2em}
div.smalllisp {margin-left: 3.2em}
kbd {font-style: oblique}
pre.display {font-family: inherit}
pre.format {font-family: inherit}
pre.menu-comment {font-family: serif}
pre.menu-preformatted {font-family: serif}
pre.smalldisplay {font-family: inherit; font-size: smaller}
pre.smallexample {font-size: smaller}
pre.smallformat {font-family: inherit; font-size: smaller}
pre.smalllisp {font-size: smaller}
span.nolinebreak {white-space: nowrap}
span.roman {font-family: initial; font-weight: normal}
span.sansserif {font-family: sans-serif; font-weight: normal}
ul.no-bullet {list-style: none}
-->
</style>


</head>

<body lang="en">
<a name="Noweb-Reference-Syntax"></a>
<div class="header">
<p>
Next: <a href="Library-of-Babel.html#Library-of-Babel" accesskey="n" rel="next">Library of Babel</a>, Previous: <a href="Editing-Source-Code.html#Editing-Source-Code" accesskey="p" rel="prev">Editing Source Code</a>, Up: <a href="Working-with-Source-Code.html#Working-with-Source-Code" accesskey="u" rel="up">Working with Source Code</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Main-Index.html#Main-Index" title="Index" rel="index">Index</a>]</p>
</div>
<hr>
<a name="Noweb-Reference-Syntax-1"></a>
<h3 class="section">15.10 Noweb Reference Syntax</h3>

<a name="index-code-block_002c-Noweb-reference"></a>
<a name="index-syntax_002c-Noweb"></a>
<a name="index-source-code_002c-Noweb-reference"></a>

<p>Org supports named blocks in Noweb<a name="DOCF144" href="#FOOT144"><sup>144</sup></a> style syntax:
</p>
<div class="example">
<pre class="example">&lt;&lt;CODE-BLOCK-ID&gt;&gt;
</pre></div>


<p>Org can replace the construct with the source code, or the results of
evaluation, of the code block identified as <var>CODE-BLOCK-ID</var>.
</p>
<a name="index-noweb_002c-header-argument"></a>
<p>The &lsquo;<samp>noweb</samp>&rsquo; header argument controls expansion of Noweb syntax
references.  Expansions occur when source code blocks are evaluated,
tangled, or exported.
</p>
<dl compact="compact">
<dt>&lsquo;<samp>no</samp>&rsquo;</dt>
<dd><p>Default.  No expansion of Noweb syntax references in the body of the
code when evaluating, tangling, or exporting.
</p>
</dd>
<dt>&lsquo;<samp>yes</samp>&rsquo;</dt>
<dd><p>Expansion of Noweb syntax references in the body of the code block
when evaluating, tangling, or exporting.
</p>
</dd>
<dt>&lsquo;<samp>tangle</samp>&rsquo;</dt>
<dd><p>Expansion of Noweb syntax references in the body of the code block
when tangling.  No expansion when evaluating or exporting.
</p>
</dd>
<dt>&lsquo;<samp>no-export</samp>&rsquo;</dt>
<dd><p>Expansion of Noweb syntax references in the body of the code block
when evaluating or tangling.  No expansion when exporting.
</p>
</dd>
<dt>&lsquo;<samp>strip-export</samp>&rsquo;</dt>
<dd><p>Expansion of Noweb syntax references in the body of the code block
when expanding prior to evaluating or tangling.  Removes Noweb
syntax references when exporting.
</p>
</dd>
<dt>&lsquo;<samp>eval</samp>&rsquo;</dt>
<dd><p>Expansion of Noweb syntax references in the body of the code block
only before evaluating.
</p></dd>
</dl>

<p>In the following example,
</p>
<div class="example">
<pre class="example">#+NAME: initialization
#+BEGIN_SRC emacs-lisp
  (setq sentence &quot;Never a foot too far, even.&quot;)
#+END_SRC

#+BEGIN_SRC emacs-lisp :noweb yes
  &lt;&lt;initialization&gt;&gt;
  (reverse sentence)
#+END_SRC
</pre></div>

<p>the second code block is expanded as
</p>
<div class="example">
<pre class="example">#+BEGIN_SRC emacs-lisp :noweb yes
  (setq sentence &quot;Never a foot too far, even.&quot;)
  (reverse sentence)
#+END_SRC
</pre></div>

<p>Noweb insertions honor prefix characters that appear before the Noweb
syntax reference.  This behavior is illustrated in the following
example.  Because the &lsquo;<samp>&lt;&lt;example&gt;&gt;</samp>&rsquo; Noweb reference appears behind the
SQL comment syntax, each line of the expanded Noweb reference is
commented.  With:
</p>
<div class="example">
<pre class="example">#+NAME: example
#+BEGIN_SRC text
  this is the
  multi-line body of example
#+END_SRC
</pre></div>

<p>this code block:
</p>
<div class="example">
<pre class="example">#+BEGIN_SRC sql :noweb yes
 ---&lt;&lt;example&gt;&gt;
#+END_SRC
</pre></div>

<p>expands to:
</p>
<div class="example">
<pre class="example">#+BEGIN_SRC sql :noweb yes
 ---this is the
 ---multi-line body of example
#+END_SRC
</pre></div>

<p>Since this change does not affect Noweb replacement text without
newlines in them, inline Noweb references are acceptable.
</p>
<p>This feature can also be used for management of indentation in
exported code snippets.  With:
</p>
<div class="example">
<pre class="example">#+NAME: if-true
#+BEGIN_SRC python :exports none
  print('do things when true')
#+end_src

#+name: if-false
#+begin_src python :exports none
  print('do things when false')
#+end_src
</pre></div>

<p>this code block:
</p>
<div class="example">
<pre class="example">#+begin_src python :noweb yes :results output
  if true:
      &lt;&lt;if-true&gt;&gt;
  else:
      &lt;&lt;if-false&gt;&gt;
#+end_src
</pre></div>

<p>expands to:
</p>
<div class="example">
<pre class="example">if true:
    print('do things when true')
else:
    print('do things when false')
</pre></div>

<a name="index-noweb_002dref_002c-header-argument"></a>
<p>When expanding Noweb style references, Org concatenates code blocks by
matching the reference name to either the code block name or, if none
is found, to the &lsquo;<samp>noweb-ref</samp>&rsquo; header argument.
</p>
<p>For simple concatenation, set this &lsquo;<samp>noweb-ref</samp>&rsquo; header argument at the
sub-tree or file level.  In the example Org file shown next, the body
of the source code in each block is extracted for concatenation to
a pure code file when tangled.
</p>
<div class="example">
<pre class="example">#+BEGIN_SRC sh :tangle yes :noweb yes :shebang #!/bin/sh
  &lt;&lt;fullest-disk&gt;&gt;
#+END_SRC
* the mount point of the fullest disk
  :PROPERTIES:
  :header-args: :noweb-ref fullest-disk
  :END:

** query all mounted disks
#+BEGIN_SRC sh
  df \
#+END_SRC

** strip the header row
#+BEGIN_SRC sh
  |sed '1d' \
#+END_SRC

** output mount point of fullest disk
#+BEGIN_SRC sh
  |awk '{if (u &lt; +$5) {u = +$5; m = $6}} END {print m}'
#+END_SRC
</pre></div>

<a name="index-noweb_002dsep_002c-header-argument"></a>
<p>By default a newline separates each noweb reference concatenation.  To
change this newline separator, edit the &lsquo;<samp>noweb-sep</samp>&rsquo; header argument.
</p>
<p>Eventually, Org can include the results of a code block rather than
its body.  To that effect, append parentheses, possibly including
arguments, to the code block name, as shown below.
</p>
<div class="example">
<pre class="example">&lt;&lt;code-block-name(optional arguments)&gt;&gt;
</pre></div>


<p>Note that when using the above approach to a code block&rsquo;s results, the
code block name set by &lsquo;<samp>NAME</samp>&rsquo; keyword is required; the reference set
by &lsquo;<samp>noweb-ref</samp>&rsquo; does not work in that case.
</p>
<p>Here is an example that demonstrates how the exported content changes
when Noweb style references are used with parentheses versus without.
With:
</p>
<div class="example">
<pre class="example">#+NAME: some-code
#+BEGIN_SRC python :var num=0 :results output :exports none
  print(num*10)
#+END_SRC
</pre></div>

<p>this code block:
</p>
<div class="example">
<pre class="example">#+BEGIN_SRC text :noweb yes
  &lt;&lt;some-code&gt;&gt;
#+END_SRC
</pre></div>

<p>expands to:
</p>
<div class="example">
<pre class="example">print(num*10)
</pre></div>


<p>Below, a similar Noweb style reference is used, but with parentheses,
while setting a variable &lsquo;<samp>num</samp>&rsquo; to 10:
</p>
<div class="example">
<pre class="example">#+BEGIN_SRC text :noweb yes
  &lt;&lt;some-code(num=10)&gt;&gt;
#+END_SRC
</pre></div>

<p>Note that now the expansion contains the results of the code block
&lsquo;<samp>some-code</samp>&rsquo;, not the code block itself:
</p>
<div class="example">
<pre class="example">100
</pre></div>

<div class="footnote">
<hr>
<h4 class="footnotes-heading">Footnotes</h4>

<h3><a name="FOOT144" href="#DOCF144">(144)</a></h3>
<p>For Noweb literate programming details, see
<a href="http://www.cs.tufts.edu/~nr/noweb/">http://www.cs.tufts.edu/~nr/noweb/</a>.</p>
</div>
<hr>
<div class="header">
<p>
Next: <a href="Library-of-Babel.html#Library-of-Babel" accesskey="n" rel="next">Library of Babel</a>, Previous: <a href="Editing-Source-Code.html#Editing-Source-Code" accesskey="p" rel="prev">Editing Source Code</a>, Up: <a href="Working-with-Source-Code.html#Working-with-Source-Code" accesskey="u" rel="up">Working with Source Code</a> &nbsp; [<a href="index.html#SEC_Contents" title="Table of contents" rel="contents">Contents</a>][<a href="Main-Index.html#Main-Index" title="Index" rel="index">Index</a>]</p>
</div>



</body>
</html>
